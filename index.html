
<!DOCTYPE html>
<html>
<head>
    <title>Google Sheets API Example</title>
    <!-- Include Google APIs Client Library -->
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
    <button onclick="handleAuthClick()">Authorize</button>
    <button onclick="getData()">Get Data</button>
    <div id="output"></div>

    <script>
        var CLIENT_ID = '53895790118-7ul82g82jbeq06c5qfbi8bodl00gpbfd.apps.googleusercontent.com'; // Replace with your client ID
        var API_KEY = 'AIzaSyBuSn1yVoR5OSDvXQvfIdLup0U2YMwBuFo'; // Replace with your API key
        var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];
        var SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";

        function handleClientLoad() {
            gapi.load('client:auth2', initClient);
        }

        function initClient() {
            gapi.client.init({
                apiKey: API_KEY,
                clientId: CLIENT_ID,
                discoveryDocs: DISCOVERY_DOCS,
                scope: SCOPES
            }).then(function () {
                console.log('Client initialized');
            });
        }

        function handleAuthClick() {
            gapi.auth2.getAuthInstance().signIn();
        }

        function getData() {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1Mloavfa_lrsSerjVTWY5_dGER2Vt0P811QEPkXlFgYs', // Replace with your spreadsheet ID
                range: 'YoungOnes Open' // Replace with your sheet name or range
            }).then(function(response) {
                var values = response.result.values;
                var output = '';
                if (values.length > 0) {
                    output += '<table>';
                    for (var i = 0; i < values.length; i++) {
                        output += '<tr>';
                        for (var j = 0; j < values[i].length; j++) {
                            output += '<td>' + values[i][j] + '</td>';
                        }
                        output += '</tr>';
                    }
                    output += '</table>';
                } else {
                    output = 'No data found.';
                }
                document.getElementById('output').innerHTML = output;
            }, function(response) {
                console.error('Error: ' + response.result.error.message);
            });
        }

        // Load the API client and auth library
        gapi.load('client:auth2', initClient);
    </script>
    <script src="https://apis.google.com/js/api.js?onload=handleClientLoad"></script>
</body>
</html>
